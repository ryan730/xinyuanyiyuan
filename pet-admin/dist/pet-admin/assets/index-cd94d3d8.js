import{a as x,r as a,c as v,h as s,w as n,o as F,n as c,D as b,E as y,m as d}from"./index-79f9e569.js";const w={name:"ExampleForm",data(){return{limitNum:1,formLabelWidth:"0px",form:{file:"",file1:""},fileList:[],sendURL:"http://ivapi.xinyunyiyun.cn/admin/userImport",rules:{file:[{required:!0,validator:(l,t,r)=>{this.fileList.length<1?r(new Error("请上传文件")):r()},trigger:"change"}]}}},methods:{exceedFile(e,l){this.$notify.warning({title:"警告",message:`只能选择 ${this.limitNum} 个文件，当前共选择了 ${e.length+l.length} 个`})},fileChange(e,l){console.log("change"),console.log(e),this.form.file=e.raw,this.form.file1=e.raw,console.log(this.form.file),console.log(l),l.length!==0&&this.$refs.exampleForm.validateField("file")},beforeUploadFile(e){console.log("before upload"),console.log(e);let l=e.name.substring(e.name.lastIndexOf(".")+1),t=e.size/1024/1024;l!=="xlsx"&&this.$notify.warning({title:"警告",message:"只能上传Excel2017（即后缀是.xlsx）的文件"}),t>10&&this.$notify.warning({title:"警告",message:"文件大小不得超过10M"})},handleSuccess(e,l,t){console.log("handleSuccess======",e,l,t);const{code:r,msg:i,data:o}=e;r==1&&o?this.$notify.success({title:"成功",message:`文件上传成功,成功导入${o==null?void 0:o.imported}条数据`}):this.$notify.error({title:"错误",message:i})},handleError(e,l,t){console.log("handleError======",e,l,t),this.$notify.error({title:"错误",message:"文件上传失败"})},handleRemove(e,l){l.length===0&&(this.form.file=null,this.$refs.exampleForm.validateField("file"))},uploadCancel(){this.$refs.uploadExcel.abort()},uploadFile(){if(!this.form.file){this.$notify.error({title:"错误",message:"请先选择文件"});return}this.$refs.uploadExcel.submit()}}},f=e=>(b("data-v-1544670e"),e=e(),y(),e),E={class:"menu-page"},C=f(()=>d("div",{class:"el-upload__text"},[c(" Drop file here or "),d("em",null,"click to upload")],-1)),L=f(()=>d("div",{class:"el-upload__tip"}," 只能上传xlsx文件，且不超过10M ",-1));function k(e,l,t,r,i,o){const u=a("upload-filled"),p=a("el-icon"),_=a("el-upload"),m=a("el-button"),h=a("el-form-item"),g=a("el-form");return F(),v("div",E,[s(g,{ref:"exampleForm",model:i.form},{default:n(()=>[s(h,{label:"","label-width":i.formLabelWidth,prop:"file"},{default:n(()=>[s(_,{class:"upload-demo",ref:"uploadExcel",drag:"",action:i.sendURL,limit:i.limitNum,"auto-upload":!1,accept:".xlsx","before-upload":o.beforeUploadFile,"on-change":o.fileChange,"on-exceed":o.exceedFile,"on-success":o.handleSuccess,"on-error":o.handleError,"on-remove":o.handleRemove,"file-list":i.fileList,multiple:"false"},{tip:n(()=>[L]),default:n(()=>[s(p,{class:"el-icon--upload"},{default:n(()=>[s(u)]),_:1}),C]),_:1},8,["action","limit","before-upload","on-change","on-exceed","on-success","on-error","on-remove","file-list"]),s(m,{size:"small",type:"primary",onClick:o.uploadFile},{default:n(()=>[c("立即上传")]),_:1},8,["onClick"]),s(m,{size:"small",onClick:o.uploadCancel},{default:n(()=>[c("取消")]),_:1},8,["onClick"])]),_:1},8,["label-width"])]),_:1},8,["model"])])}const N=x(w,[["render",k],["__scopeId","data-v-1544670e"]]);export{N as default};
